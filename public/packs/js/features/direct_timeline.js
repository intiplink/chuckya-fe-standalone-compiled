(window.webpackJsonp=window.webpackJsonp||[]).push([[455],{2022:function(e,t,a){"use strict";a.r(t);var o=a(0),c=a(1),s=a(8),n=a(72),i=a(26),r=a(201),l=a(10),d=a(281),u=a(328),b=a(344),m=a(1774),j=a(556),O=a(1231),p=a(96),v=a.n(p),g=a(1511),_=(a(41),a(9)),f=a.n(_),h=a(47),M=a(38),y=a(173),k=a(152),C=a(203),x=a(266),w=a(25),I=a(67),N=a(116),T=a(1704),D=a(2),S=a(19),L=a(190);class P extends c.PureComponent{renderItem(e,t,a){const{animate:c}=this.props;let s=50,n=100,i="auto",r="auto",l="auto",d="auto";1===t&&(s=100),(4===t||3===t&&a>0)&&(n=50),2===t?0===a?d="1px":r="1px":3===t?(0===a?d="1px":a>0&&(r="1px"),1===a?l="1px":a>1&&(i="1px")):4===t&&(0!==a&&2!==a||(d="1px"),1!==a&&3!==a||(r="1px"),a<2?l="1px":i="1px");const u={left:r,top:i,right:d,bottom:l,width:"".concat(s,"%"),height:"".concat(n,"%")};return Object(o.a)("div",{style:u},e.get("id"),Object(o.a)(L.a,{account:e,animate:c}))}render(){const{accounts:e,size:t}=this.props;return Object(o.a)("div",{className:"account__avatar-composite",style:{width:"".concat(t,"px"),height:"".concat(t,"px")}},void 0,e.take(4).map(((t,a)=>this.renderItem(t,Math.min(e.size,4),a))),e.size>4&&Object(o.a)("span",{className:"account__avatar-composite__label"},void 0,"+",e.size-4))}}Object(D.a)(P,"defaultProps",{animate:S.a});var R=a(77),z=a(245),K=a(541),A=a(494),E=a(252);const H=Object(s.d)({more:{id:"status.more",defaultMessage:"More"},open:{id:"conversation.open",defaultMessage:"View conversation"},reply:{id:"status.reply",defaultMessage:"Reply"},markAsRead:{id:"conversation.mark_as_read",defaultMessage:"Mark as read"},delete:{id:"conversation.delete",defaultMessage:"Delete conversation"},muteConversation:{id:"status.mute_conversation",defaultMessage:"Mute conversation"},unmuteConversation:{id:"status.unmute_conversation",defaultMessage:"Unmute conversation"}}),q=Object(y.a)((e=>e.get("accounts")),((e,t)=>t),((e,t)=>t.map((t=>e.get(t))))),U=Object(E.i)(),V=e=>{let{conversation:t,scrollKey:a,onMoveUp:s,onMoveDown:r}=e;const d=t.get("id"),u=t.get("unread"),m=t.get("last_status"),j=t.get("accounts"),O=Object(n.a)(),p=Object(l.useDispatch)(),v=Object(h.g)(),g=Object(l.useSelector)((e=>U(e,{id:m}))),_=Object(l.useSelector)((e=>q(e,j))),y=Object(c.useCallback)((e=>{let{currentTarget:t}=e;if(S.a)return;const a=t.querySelectorAll(".custom-emoji");for(var o=0;o<a.length;o++){let e=a[o];e.src=e.getAttribute("data-original")}}),[]),D=Object(c.useCallback)((e=>{let{currentTarget:t}=e;if(S.a)return;const a=t.querySelectorAll(".custom-emoji");for(var o=0;o<a.length;o++){let e=a[o];e.src=e.getAttribute("data-static")}}),[]),L=Object(c.useCallback)((()=>{u&&p(Object(b.k)(d)),v.push("/@".concat(g.getIn(["account","acct"]),"/").concat(g.get("id")))}),[p,v,u,d,g]),E=Object(c.useCallback)((()=>{p(Object(b.k)(d))}),[p,d]),V=Object(c.useCallback)((()=>{p(((e,t)=>{0!==t().getIn(["compose","text"]).trim().length?p(Object(I.b)({modalType:"CONFIRM_REPLY",modalProps:{status:g}})):p(Object(w.vb)(g))}))}),[p,g]),J=Object(c.useCallback)((()=>{p(Object(b.i)(d))}),[p,d]),W=Object(c.useCallback)((()=>{s(d)}),[d,s]),Y=Object(c.useCallback)((()=>{r(d)}),[d,r]),F=Object(c.useCallback)((()=>{g.get("muted")?p(Object(N.w)(g.get("id"))):p(Object(N.p)(g.get("id")))}),[p,g]),B=Object(c.useCallback)((()=>{p(Object(N.t)(g.get("id")))}),[p,g]);if(!g)return null;const G=[{text:O.formatMessage(H.open),action:L},null,{text:O.formatMessage(g.get("muted")?H.unmuteConversation:H.muteConversation),action:F}];u&&(G.push({text:O.formatMessage(H.markAsRead),action:E}),G.push(null)),G.push({text:O.formatMessage(H.delete),action:J});const Q=_.map((e=>Object(o.a)(M.a,{to:"/@".concat(e.get("acct")),"data-hover-card-account":e.get("id")},e.get("id"),Object(o.a)("bdi",{},void 0,Object(o.a)("strong",{className:"display-name__html",dangerouslySetInnerHTML:{__html:e.get("display_name_html")}}))))).reduce(((e,t)=>[e,", ",t])),X={reply:V,open:L,moveUp:W,moveDown:Y,toggleHidden:B};return Object(o.a)(k.HotKeys,{handlers:X},void 0,Object(o.a)("div",{className:f()("conversation focusable muted",{"conversation--unread":u}),tabIndex:0},void 0,Object(o.a)("div",{className:"conversation__avatar",onClick:L,role:"presentation"},void 0,Object(o.a)(P,{accounts:_,size:48})),Object(o.a)("div",{className:"conversation__content"},void 0,Object(o.a)("div",{className:"conversation__content__info"},void 0,Object(o.a)("div",{className:"conversation__content__relative-time"},void 0,u&&Object(o.a)("span",{className:"conversation__unread"})," ",Object(o.a)(z.a,{timestamp:g.get("created_at")})),Object(o.a)("div",{className:"conversation__content__names",onMouseEnter:y,onMouseLeave:D},void 0,Object(o.a)(i.a,{id:"conversation.with",defaultMessage:"With {names}",values:{names:Object(o.a)("span",{},void 0,Q)}}))),Object(o.a)(K.a,{status:g,onClick:L,expanded:!g.get("hidden"),onExpandedToggle:B,collapsible:!0}),g.get("media_attachments").size>0&&Object(o.a)(T.a,{compact:!0,media:g.get("media_attachments")}),Object(o.a)("div",{className:"status__action-bar"},void 0,Object(o.a)(R.a,{className:"status__action-bar-button",title:O.formatMessage(H.reply),icon:"reply",iconComponent:x.a,onClick:V}),Object(o.a)("div",{className:"status__action-bar-dropdown"},void 0,Object(o.a)(A.a,{scrollKey:a,status:g,items:G,icon:"ellipsis-h",iconComponent:C.a,size:18,direction:"right",title:O.formatMessage(H.more)}))))))};var J=a(6);const W=(e,t,a)=>{const o=e.querySelector("article:nth-of-type(".concat(t+1,") .focusable"));o&&(a&&e.scrollTop>o.offsetTop?o.scrollIntoView(!0):!a&&e.scrollTop+e.clientHeight<o.offsetTop+o.offsetHeight&&o.scrollIntoView(!1),o.focus())},Y=e=>{var t;let{scrollKey:a,...s}=e;const n=Object(c.useRef)(),i=Object(l.useSelector)((e=>e.getIn(["conversations","items"]))),r=Object(l.useSelector)((e=>e.getIn(["conversations","isLoading"],!0))),d=Object(l.useSelector)((e=>e.getIn(["conversations","hasMore"],!1))),u=Object(l.useDispatch)(),m=null===(t=i.last())||void 0===t?void 0:t.get("last_status"),j=Object(c.useCallback)((e=>{const t=i.findIndex((t=>t.get("id")===e))-1;W(n.current.node,t,!0)}),[n,i]),O=Object(c.useCallback)((e=>{const t=i.findIndex((t=>t.get("id")===e))+1;W(n.current.node,t,!1)}),[n,i]),p=Object(c.useMemo)((()=>v()((e=>{u(Object(b.j)({maxId:e}))}),300,{leading:!0})),[u]),_=Object(c.useCallback)((()=>{m&&p(m)}),[p,m]);return Object(J.jsx)(g.a,{...s,scrollKey:a,isLoading:r,showLoading:r&&i.isEmpty(),hasMore:d,onLoadMore:_,ref:n,children:i.map((e=>Object(o.a)(V,{conversation:e,onMoveUp:j,onMoveDown:O,scrollKey:a},e.get("id"))))})},F=Object(s.d)({title:{id:"column.direct",defaultMessage:"Private mentions"}});t.default=e=>{let{columnId:t,multiColumn:a}=e;const s=Object(c.useRef)(),p=Object(n.a)(),v=Object(l.useDispatch)(),g=!!t,_=Object(c.useCallback)((()=>{v(t?Object(u.h)(t):Object(u.e)("DIRECT",{}))}),[v,t]),f=Object(c.useCallback)((e=>{v(Object(u.g)(t,e))}),[v,t]),h=Object(c.useCallback)((()=>{s.current.scrollTop()}),[s]);return Object(c.useEffect)((()=>{v(Object(b.l)()),v(Object(b.j)());const e=v(Object(m.b)());return()=>{v(Object(b.m)()),e()}}),[v]),Object(J.jsxs)(j.a,{bindToDocument:!a,ref:s,label:p.formatMessage(F.title),children:[Object(o.a)(O.b,{icon:"at",iconComponent:d.a,title:p.formatMessage(F.title),onPin:_,onMove:f,onClick:h,pinned:g,multiColumn:a}),Object(o.a)(Y,{trackScroll:!g,scrollKey:"direct_timeline-".concat(t),emptyMessage:Object(o.a)(i.a,{id:"empty_column.direct",defaultMessage:"You don't have any private mentions yet. When you send or receive one, it will show up here."}),bindToDocument:!a,prepend:Object(o.a)("div",{className:"follow_requests-unlocked_explanation"},void 0,Object(o.a)("span",{},void 0,Object(o.a)(i.a,{id:"compose_form.encryption_warning",defaultMessage:"Posts on Mastodon are not end-to-end encrypted. Do not share any dangerous information over Mastodon."})," ",Object(o.a)("a",{href:"/terms",target:"_blank"},void 0,Object(o.a)(i.a,{id:"compose_form.direct_message_warning_learn_more",defaultMessage:"Learn more"})))),alwaysPrepend:!0}),Object(o.a)(r.a,{},void 0,Object(o.a)("title",{},void 0,p.formatMessage(F.title)),Object(o.a)("meta",{name:"robots",content:"noindex"}))]})}}}]);
//# sourceMappingURL=direct_timeline.js.map