(window.webpackJsonp=window.webpackJsonp||[]).push([[530],{1967:function(t,e,i){"use strict";i.r(e);var n=i(0),a=i(2),o=i(101),s=i.n(o),c=(i(45),i(14),i(1)),l=i(8),r=i(26),d=i(54),b=i(9),f=i.n(b),g=i(247),h=i(198),u=i(5),p=i(10),O=i(2088),j=i(2099),m=i(1498),v=i(143),_=i(31),C=i(2118),M=i(126),w=i(537),k=i(303),P=i(64),N=i(1291),y=i(1289),x=i(1897),I=i(1865),F=i(49),q=i(4),S=i.n(q),A=i(37),D=i(1496);const T=Object(l.d)({btnAll:{id:"notification_purge.btn_all",defaultMessage:"Select all"},btnNone:{id:"notification_purge.btn_none",defaultMessage:"Select none"},btnInvert:{id:"notification_purge.btn_invert",defaultMessage:"Invert selection"},btnApply:{id:"notification_purge.btn_apply",defaultMessage:"Clear selected"}});class R extends A.a{render(){const{intl:t,markNewForDelete:e}=this.props;return Object(n.a)("div",{className:"column-header__notif-cleaning-buttons"},void 0,Object(n.a)("button",{onClick:this.props.onMarkAll,className:f()("column-header__button",{active:e})},void 0,Object(n.a)("b",{},void 0,"∀"),Object(n.a)("br",{}),t.formatMessage(T.btnAll)),Object(n.a)("button",{onClick:this.props.onMarkNone,className:f()("column-header__button",{active:!e})},void 0,Object(n.a)("b",{},void 0,"∅"),Object(n.a)("br",{}),t.formatMessage(T.btnNone)),Object(n.a)("button",{onClick:this.props.onInvert,className:"column-header__button"},void 0,Object(n.a)("b",{},void 0,"¬"),Object(n.a)("br",{}),t.formatMessage(T.btnInvert)),Object(n.a)("button",{onClick:this.props.onDeleteMarked,className:"column-header__button"},void 0,Object(n.a)(_.a,{id:"trash",icon:D.a}),Object(n.a)("br",{}),t.formatMessage(T.btnApply)))}}Object(a.a)(R,"propTypes",{onDeleteMarked:S.a.func.isRequired,onMarkAll:S.a.func.isRequired,onMarkNone:S.a.func.isRequired,onInvert:S.a.func.isRequired,intl:S.a.object.isRequired,markNewForDelete:S.a.bool});var L=Object(d.c)(R);const E=Object(l.d)({clearMessage:{id:"notifications.marked_clear_confirmation",defaultMessage:"Are you sure you want to permanently clear all selected notifications?"},clearConfirm:{id:"notifications.marked_clear",defaultMessage:"Clear selected notifications"}});var U=Object(d.c)(Object(p.connect)((t=>({markNewForDelete:t.getIn(["notifications","markNewForDelete"])})),((t,e)=>{let{intl:i}=e;return{onEnterCleaningMode(e){t(Object(P.O)(e))},onDeleteMarked(){t(Object(F.b)({modalType:"CONFIRM",modalProps:{message:i.formatMessage(E.clearMessage),confirm:i.formatMessage(E.clearConfirm),onConfirm:()=>t(Object(P.M)())}}))},onMarkAll(){t(Object(P.W)(!0))},onMarkNone(){t(Object(P.W)(!1))},onInvert(){t(Object(P.W)(null))}}}))(L)),B=i(40),H=i(2071),W=i(1481),z=i(88),G=i(345);const Q=()=>{const t=Object(z.b)(),e=Object(z.c)((t=>t.notificationPolicy));return Object(c.useEffect)((()=>{t(Object(W.a)());const e=setInterval((()=>{t(Object(W.a)())}),12e4);return()=>{clearInterval(e)}}),[t]),null===e||0===e.summary.pending_notifications_count?null:Object(n.a)(B.a,{className:"filtered-notifications-banner",to:"/notifications/requests"},void 0,Object(n.a)(_.a,{icon:H.a,id:"filtered-notifications"}),Object(n.a)("div",{className:"filtered-notifications-banner__text"},void 0,Object(n.a)("strong",{},void 0,Object(n.a)(r.a,{id:"filtered_notifications_banner.title",defaultMessage:"Filtered notifications"})),Object(n.a)("span",{},void 0,Object(n.a)(r.a,{id:"filtered_notifications_banner.pending_requests",defaultMessage:"Notifications from {count, plural, =0 {no one} one {one person} other {# people}} you may know",values:{count:e.summary.pending_requests_count}}))),Object(n.a)("div",{className:"filtered-notifications-banner__badge"},void 0,Object(n.a)("div",{className:"filtered-notifications-banner__badge__badge"},void 0,Object(G.d)(e.summary.pending_notifications_count)),Object(n.a)(r.a,{id:"filtered_notifications_banner.mentions",defaultMessage:"{count, plural, one {mention} other {mentions}}",values:{count:e.summary.pending_notifications_count}})))};var V=i(2100),Y=i(83),J=i(166),K=i(100),Z=i(51);const X=Object(l.d)({close:{id:"lightbox.close",defaultMessage:"Close"}});class $ extends c.PureComponent{constructor(){super(...arguments),Object(a.a)(this,"handleClick",(()=>{this.props.dispatch(Object(P.cb)())})),Object(a.a)(this,"handleClose",(()=>{this.props.dispatch(Object(J.c)(["notifications","dismissPermissionBanner"],!0))}))}render(){const{intl:t}=this.props;return Object(n.a)("div",{className:"notifications-permission-banner"},void 0,Object(n.a)("div",{className:"notifications-permission-banner__close"},void 0,Object(n.a)(Z.a,{icon:"times",iconComponent:Y.a,onClick:this.handleClose,title:t.formatMessage(X.close)})),Object(n.a)("h2",{},void 0,Object(n.a)(r.a,{id:"notifications_permission_banner.title",defaultMessage:"Never miss a thing"})),Object(n.a)("p",{},void 0,Object(n.a)(r.a,{id:"notifications_permission_banner.how_to_control",defaultMessage:"To receive notifications when Mastodon isn't open, enable desktop notifications. You can control precisely which types of interactions generate desktop notifications through the {icon} button above once they're enabled.",values:{icon:Object(n.a)(_.a,{id:"sliders",icon:V.a})}})),Object(n.a)(K.a,{onClick:this.handleClick},void 0,Object(n.a)(r.a,{id:"notifications_permission_banner.enable",defaultMessage:"Enable desktop notifications"})))}}var tt=Object(p.connect)()(Object(d.c)($)),et=i(189),it=i(490),nt=i(239),at=i(1718),ot=i.n(at);const st=t=>{let{checked:e,disabled:i,children:a,onChange:o}=t;const s=Object(c.useCallback)((t=>{let{target:e}=t;o(e.checked)}),[o]);return Object(n.a)("label",{className:"app-form__toggle"},void 0,Object(n.a)("div",{className:"app-form__toggle__label"},void 0,a),Object(n.a)("div",{className:"app-form__toggle__toggle"},void 0,Object(n.a)("div",{},void 0,Object(n.a)(ot.a,{checked:e,onChange:s,disabled:i}))))};class ct extends c.PureComponent{render(){return Object(n.a)("button",{className:"text-btn column-header__setting-btn",tabIndex:0,onClick:this.props.onClick},void 0,Object(n.a)(_.a,{id:"eraser",icon:O.a})," ",Object(n.a)(r.a,{id:"notifications.clear",defaultMessage:"Clear notifications"}))}}class lt extends c.PureComponent{render(){return Object(n.a)("button",{className:"text-btn column-header__permission-btn",tabIndex:0,onClick:this.props.onClick},void 0,Object(n.a)(r.a,{id:"notifications.grant_permission",defaultMessage:"Grant permission."}))}}class rt extends c.PureComponent{constructor(){super(...arguments),Object(a.a)(this,"onChange",(()=>{const{settings:t,settingPath:e}=this.props;this.props.onChange(e,!t.getIn(e))}))}render(){const{prefix:t,settings:e,settingPath:i,label:a,disabled:o}=this.props,s=["setting-pillbar-button",t,...i].filter(Boolean).join("-"),c=e.getIn(i);return Object(n.a)("button",{id:s,className:f()("pillbar-button",{active:c}),disabled:o,onClick:this.onChange,"aria-pressed":c},s,a)}}var dt=i(2070);class bt extends c.PureComponent{constructor(){super(...arguments),Object(a.a)(this,"onPushChange",((t,e)=>{this.props.onChange(["push",...t],e)})),Object(a.a)(this,"handleFilterNotFollowing",(t=>{this.props.onChangePolicy("filter_not_following",t)})),Object(a.a)(this,"handleFilterNotFollowers",(t=>{this.props.onChangePolicy("filter_not_followers",t)})),Object(a.a)(this,"handleFilterNewAccounts",(t=>{this.props.onChangePolicy("filter_new_accounts",t)})),Object(a.a)(this,"handleFilterPrivateMentions",(t=>{this.props.onChangePolicy("filter_private_mentions",t)}))}render(){const{settings:t,pushSettings:e,onChange:i,onClear:a,alertsEnabled:o,browserSupport:s,browserPermission:c,onRequestNotificationPermission:l,notificationPolicy:d}=this.props,b=Object(n.a)(r.a,{id:"notifications.column_settings.unread_notifications.highlight",defaultMessage:"Highlight unread notifications"}),f=Object(n.a)(r.a,{id:"notifications.column_settings.filter_bar.show_bar",defaultMessage:"Show filter bar"}),g=Object(n.a)(r.a,{id:"notifications.column_settings.filter_bar.advanced",defaultMessage:"Display all categories"}),h=Object(n.a)(r.a,{id:"notifications.column_settings.alert",defaultMessage:"Desktop notifications"}),u=Object(n.a)(r.a,{id:"notifications.column_settings.show",defaultMessage:"Show in column"}),p=Object(n.a)(r.a,{id:"notifications.column_settings.sound",defaultMessage:"Play sound"}),O=e.get("browserSupport")&&e.get("isSubscribed"),j=O&&Object(n.a)(r.a,{id:"notifications.column_settings.push",defaultMessage:"Push notifications"});return Object(n.a)("div",{className:"column-settings"},void 0,o&&s&&"denied"===c&&Object(n.a)("span",{className:"warning-hint"},void 0,Object(n.a)(r.a,{id:"notifications.permission_denied",defaultMessage:"Desktop notifications are unavailable due to previously denied browser permissions request"})),Object(n.a)("section",{},void 0,Object(n.a)(ct,{onClick:a})),o&&s&&"default"===c&&Object(n.a)("section",{},void 0,Object(n.a)("span",{className:"warning-hint"},void 0,Object(n.a)(r.a,{id:"notifications.permission_required",defaultMessage:"Desktop notifications are unavailable because the required permission has not been granted."})," ",Object(n.a)(lt,{onClick:l}))),Object(n.a)("section",{},void 0,Object(n.a)("h3",{},void 0,Object(n.a)(r.a,{id:"notifications.policy.title",defaultMessage:"Filter out notifications from…"})),Object(n.a)("div",{className:"column-settings__row"},void 0,Object(n.a)(st,{checked:d.filter_not_following,onChange:this.handleFilterNotFollowing},void 0,Object(n.a)("strong",{},void 0,Object(n.a)(r.a,{id:"notifications.policy.filter_not_following_title",defaultMessage:"People you don't follow"})),Object(n.a)("span",{className:"hint"},void 0,Object(n.a)(r.a,{id:"notifications.policy.filter_not_following_hint",defaultMessage:"Until you manually approve them"}))),Object(n.a)(st,{checked:d.filter_not_followers,onChange:this.handleFilterNotFollowers},void 0,Object(n.a)("strong",{},void 0,Object(n.a)(r.a,{id:"notifications.policy.filter_not_followers_title",defaultMessage:"People not following you"})),Object(n.a)("span",{className:"hint"},void 0,Object(n.a)(r.a,{id:"notifications.policy.filter_not_followers_hint",defaultMessage:"Including people who have been following you fewer than {days, plural, one {one day} other {# days}}",values:{days:3}}))),Object(n.a)(st,{checked:d.filter_new_accounts,onChange:this.handleFilterNewAccounts},void 0,Object(n.a)("strong",{},void 0,Object(n.a)(r.a,{id:"notifications.policy.filter_new_accounts_title",defaultMessage:"New accounts"})),Object(n.a)("span",{className:"hint"},void 0,Object(n.a)(r.a,{id:"notifications.policy.filter_new_accounts.hint",defaultMessage:"Created within the past {days, plural, one {one day} other {# days}}",values:{days:30}}))),Object(n.a)(st,{checked:d.filter_private_mentions,onChange:this.handleFilterPrivateMentions},void 0,Object(n.a)("strong",{},void 0,Object(n.a)(r.a,{id:"notifications.policy.filter_private_mentions_title",defaultMessage:"Unsolicited private mentions"})),Object(n.a)("span",{className:"hint"},void 0,Object(n.a)(r.a,{id:"notifications.policy.filter_private_mentions_hint",defaultMessage:"Filtered unless it's in reply to your own mention or if you follow the sender"}))))),Object(n.a)("section",{role:"group","aria-labelledby":"notifications-filter-bar"},void 0,Object(n.a)("h3",{id:"notifications-filter-bar"},void 0,Object(n.a)(r.a,{id:"notifications.column_settings.filter_bar.category",defaultMessage:"Quick filter bar"})),Object(n.a)("div",{className:"column-settings__row"},void 0,Object(n.a)(dt.a,{id:"show-filter-bar",prefix:"notifications",settings:t,settingPath:["quickFilter","show"],onChange:i,label:f}),Object(n.a)(dt.a,{id:"show-filter-bar",prefix:"notifications",settings:t,settingPath:["quickFilter","advanced"],onChange:i,label:g}))),Object(n.a)("section",{role:"group","aria-labelledby":"notifications-unread-markers"},void 0,Object(n.a)("h3",{id:"notifications-unread-markers"},void 0,Object(n.a)(r.a,{id:"notifications.column_settings.unread_notifications.category",defaultMessage:"Unread notifications"})),Object(n.a)("div",{className:"column-settings__row"},void 0,Object(n.a)(dt.a,{id:"unread-notification-markers",prefix:"notifications",settings:t,settingPath:["showUnread"],onChange:i,label:b}))),Object(n.a)("section",{role:"group","aria-labelledby":"notifications-follow"},void 0,Object(n.a)("h3",{id:"notifications-follow"},void 0,Object(n.a)(r.a,{id:"notifications.column_settings.follow",defaultMessage:"New followers:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(rt,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","follow"],onChange:i,label:h}),O&&Object(n.a)(rt,{prefix:"notifications_push",settings:e,settingPath:["alerts","follow"],onChange:this.onPushChange,label:j}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["shows","follow"],onChange:i,label:u}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["sounds","follow"],onChange:i,label:p}))),Object(n.a)("section",{role:"group","aria-labelledby":"notifications-follow-request"},void 0,Object(n.a)("h3",{id:"notifications-follow-request"},void 0,Object(n.a)(r.a,{id:"notifications.column_settings.follow_request",defaultMessage:"New follow requests:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(rt,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","follow_request"],onChange:i,label:h}),O&&Object(n.a)(rt,{prefix:"notifications_push",settings:e,settingPath:["alerts","follow_request"],onChange:this.onPushChange,label:j}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["shows","follow_request"],onChange:i,label:u}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["sounds","follow_request"],onChange:i,label:p}))),Object(n.a)("section",{role:"group","aria-labelledby":"notifications-favourite"},void 0,Object(n.a)("h3",{id:"notifications-favourite"},void 0,Object(n.a)(r.a,{id:"notifications.column_settings.favourite",defaultMessage:"Favorites:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(rt,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","favourite"],onChange:i,label:h}),O&&Object(n.a)(rt,{prefix:"notifications_push",settings:e,settingPath:["alerts","favourite"],onChange:this.onPushChange,label:j}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["shows","favourite"],onChange:i,label:u}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["sounds","favourite"],onChange:i,label:p}))),Object(n.a)("section",{role:"group","aria-labelledby":"notifications-reaction"},void 0,Object(n.a)("h3",{id:"notifications-reaction"},void 0,Object(n.a)(r.a,{id:"notifications.column_settings.reaction",defaultMessage:"Reactions:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(rt,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","reaction"],onChange:i,label:h}),O&&Object(n.a)(rt,{prefix:"notifications_push",settings:e,settingPath:["alerts","reaction"],onChange:this.onPushChange,label:j}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["shows","reaction"],onChange:i,label:u}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["sounds","reaction"],onChange:i,label:p}))),Object(n.a)("section",{role:"group","aria-labelledby":"notifications-mention"},void 0,Object(n.a)("h3",{id:"notifications-mention"},void 0,Object(n.a)(r.a,{id:"notifications.column_settings.mention",defaultMessage:"Mentions:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(rt,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","mention"],onChange:i,label:h}),O&&Object(n.a)(rt,{prefix:"notifications_push",settings:e,settingPath:["alerts","mention"],onChange:this.onPushChange,label:j}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["shows","mention"],onChange:i,label:u}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["sounds","mention"],onChange:i,label:p}))),Object(n.a)("section",{role:"group","aria-labelledby":"notifications-reblog"},void 0,Object(n.a)("h3",{id:"notifications-reblog"},void 0,Object(n.a)(r.a,{id:"notifications.column_settings.reblog",defaultMessage:"Boosts:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(rt,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","reblog"],onChange:i,label:h}),O&&Object(n.a)(rt,{prefix:"notifications_push",settings:e,settingPath:["alerts","reblog"],onChange:this.onPushChange,label:j}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["shows","reblog"],onChange:i,label:u}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["sounds","reblog"],onChange:i,label:p}))),Object(n.a)("section",{role:"group","aria-labelledby":"notifications-poll"},void 0,Object(n.a)("h3",{id:"notifications-poll"},void 0,Object(n.a)(r.a,{id:"notifications.column_settings.poll",defaultMessage:"Poll results:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(rt,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","poll"],onChange:i,label:h}),O&&Object(n.a)(rt,{prefix:"notifications_push",settings:e,settingPath:["alerts","poll"],onChange:this.onPushChange,label:j}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["shows","poll"],onChange:i,label:u}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["sounds","poll"],onChange:i,label:p}))),Object(n.a)("section",{role:"group","aria-labelledby":"notifications-status"},void 0,Object(n.a)("h3",{id:"notifications-status"},void 0,Object(n.a)(r.a,{id:"notifications.column_settings.status",defaultMessage:"New posts:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(rt,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","status"],onChange:i,label:h}),O&&Object(n.a)(rt,{prefix:"notifications_push",settings:e,settingPath:["alerts","status"],onChange:this.onPushChange,label:j}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["shows","status"],onChange:i,label:u}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["sounds","status"],onChange:i,label:p}))),Object(n.a)("section",{role:"group","aria-labelledby":"notifications-update"},void 0,Object(n.a)("h3",{id:"notifications-update"},void 0,Object(n.a)(r.a,{id:"notifications.column_settings.update",defaultMessage:"Edits:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(rt,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","update"],onChange:i,label:h}),O&&Object(n.a)(rt,{prefix:"notifications_push",settings:e,settingPath:["alerts","update"],onChange:this.onPushChange,label:j}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["shows","update"],onChange:i,label:u}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["sounds","update"],onChange:i,label:p}))),(this.props.identity.permissions&nt.d)===nt.d&&Object(n.a)("section",{role:"group","aria-labelledby":"notifications-admin-sign-up"},void 0,Object(n.a)("h3",{id:"notifications-status"},void 0,Object(n.a)(r.a,{id:"notifications.column_settings.admin.sign_up",defaultMessage:"New sign-ups:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(rt,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","admin.sign_up"],onChange:i,label:h}),O&&Object(n.a)(rt,{prefix:"notifications_push",settings:e,settingPath:["alerts","admin.sign_up"],onChange:this.onPushChange,label:j}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["shows","admin.sign_up"],onChange:i,label:u}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["sounds","admin.sign_up"],onChange:i,label:p}))),(this.props.identity.permissions&nt.c)===nt.c&&Object(n.a)("section",{role:"group","aria-labelledby":"notifications-admin-report"},void 0,Object(n.a)("h3",{id:"notifications-status"},void 0,Object(n.a)(r.a,{id:"notifications.column_settings.admin.report",defaultMessage:"New reports:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(rt,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","admin.report"],onChange:i,label:h}),O&&Object(n.a)(rt,{prefix:"notifications_push",settings:e,settingPath:["alerts","admin.report"],onChange:this.onPushChange,label:j}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["shows","admin.report"],onChange:i,label:u}),Object(n.a)(rt,{prefix:"notifications",settings:t,settingPath:["sounds","admin.report"],onChange:i,label:p}))))}}var ft=Object(M.e)(bt);const gt=Object(l.d)({clearMessage:{id:"notifications.clear_confirmation",defaultMessage:"Are you sure you want to permanently clear all your notifications?"},clearConfirm:{id:"notifications.clear",defaultMessage:"Clear notifications"},permissionDenied:{id:"notifications.permission_denied_alert",defaultMessage:"Desktop notifications can't be enabled, as browser permission has been denied before"}});var ht=Object(d.c)(Object(p.connect)((t=>({settings:t.getIn(["settings","notifications"]),pushSettings:t.get("push_notifications"),alertsEnabled:t.getIn(["settings","notifications","alerts"]).includes(!0),browserSupport:t.getIn(["notifications","browserSupport"]),browserPermission:t.getIn(["notifications","browserPermission"]),notificationPolicy:t.notificationPolicy})),((t,e)=>{let{intl:i}=e;return{onChange(e,i){"push"===e[0]?i&&void 0!==window.Notification&&"granted"!==Notification.permission?t(Object(P.cb)((n=>{t("granted"===n?Object(it.changeAlerts)(e.slice(1),i):Object(et.e)({message:gt.permissionDenied}))}))):t(Object(it.changeAlerts)(e.slice(1),i)):"quickFilter"===e[0]?(t(Object(J.c)(["notifications",...e],i)),t(Object(P.eb)("all"))):"alerts"===e[0]&&i&&void 0!==window.Notification&&"granted"!==Notification.permission&&i&&void 0!==window.Notification&&"granted"!==Notification.permission?t(Object(P.cb)((n=>{t("granted"===n?Object(J.c)(["notifications",...e],i):Object(et.e)({message:gt.permissionDenied}))}))):t(Object(J.c)(["notifications",...e],i))},onClear(){t(Object(F.b)({modalType:"CONFIRM",modalProps:{message:i.formatMessage(gt.clearMessage),confirm:i.formatMessage(gt.clearConfirm),onConfirm:()=>t(Object(P.L)())}}))},onRequestNotificationPermission(){t(Object(P.cb)())},onChangePolicy(e,i){t(Object(W.b)({[e]:i}))}}}))(ft)),ut=i(529),pt=i(423),Ot=i(1694),jt=i(1492),mt=i(221),vt=i(386),_t=i(316);const Ct=Object(l.d)({mentions:{id:"notifications.filter.mentions",defaultMessage:"Mentions"},favourites:{id:"notifications.filter.favourites",defaultMessage:"Favorites"},reactions:{id:"notifications.filter.reactions",defaultMessage:"Reactions"},boosts:{id:"notifications.filter.boosts",defaultMessage:"Boosts"},polls:{id:"notifications.filter.polls",defaultMessage:"Poll results"},follows:{id:"notifications.filter.follows",defaultMessage:"Follows"},statuses:{id:"notifications.filter.statuses",defaultMessage:"Updates from people you follow"}});class Mt extends c.PureComponent{onClick(t){return()=>this.props.selectFilter(t)}render(){const{selectedFilter:t,advancedMode:e,intl:i}=this.props;return e?Object(n.a)("div",{className:"notification__filter-bar"},void 0,Object(n.a)("button",{className:"all"===t?"active":"",onClick:this.onClick("all")},void 0,Object(n.a)(r.a,{id:"notifications.filter.all",defaultMessage:"All"})),Object(n.a)("button",{className:"mention"===t?"active":"",onClick:this.onClick("mention"),title:i.formatMessage(Ct.mentions)},void 0,Object(n.a)(_.a,{id:"reply-all",icon:vt.a})),Object(n.a)("button",{className:"favourite"===t?"active":"",onClick:this.onClick("favourite"),title:i.formatMessage(Ct.favourites)},void 0,Object(n.a)(_.a,{id:"star",icon:_t.a})),Object(n.a)("button",{className:"reaction"===t?"active":"",onClick:this.onClick("reaction"),title:i.formatMessage(Ct.reactions)},void 0,Object(n.a)(_.a,{id:"mood",icon:Ot.a})),Object(n.a)("button",{className:"reblog"===t?"active":"",onClick:this.onClick("reblog"),title:i.formatMessage(Ct.boosts)},void 0,Object(n.a)(_.a,{id:"retweet",icon:mt.a})),Object(n.a)("button",{className:"poll"===t?"active":"",onClick:this.onClick("poll"),title:i.formatMessage(Ct.polls)},void 0,Object(n.a)(_.a,{id:"tasks",icon:pt.a})),Object(n.a)("button",{className:"status"===t?"active":"",onClick:this.onClick("status"),title:i.formatMessage(Ct.statuses)},void 0,Object(n.a)(_.a,{id:"home",icon:ut.a})),Object(n.a)("button",{className:"follow"===t?"active":"",onClick:this.onClick("follow"),title:i.formatMessage(Ct.follows)},void 0,Object(n.a)(_.a,{id:"user-plus",icon:jt.a}))):Object(n.a)("div",{className:"notification__filter-bar"},void 0,Object(n.a)("button",{className:"all"===t?"active":"",onClick:this.onClick("all")},void 0,Object(n.a)(r.a,{id:"notifications.filter.all",defaultMessage:"All"})),Object(n.a)("button",{className:"mention"===t?"active":"",onClick:this.onClick("mention")},void 0,Object(n.a)(r.a,{id:"notifications.filter.mentions",defaultMessage:"Mentions"})))}}var wt=Object(d.c)(Mt);var kt=Object(p.connect)((t=>({selectedFilter:t.getIn(["settings","notifications","quickFilter","active"]),advancedMode:t.getIn(["settings","notifications","quickFilter","advanced"])})),(t=>({selectFilter(e){t(Object(P.eb)(e))}})))(wt),Pt=i(2125),Nt=i(6);const yt=Object(l.d)({title:{id:"column.notifications",defaultMessage:"Notifications"},enterNotifCleaning:{id:"notification_purge.start",defaultMessage:"Enter notification cleaning mode"},markAsRead:{id:"notifications.mark_as_read",defaultMessage:"Mark every notification as read"}}),xt=Object(h.a)([t=>t.getIn(["settings","notifications","shows"])],(t=>Object(u.List)(t.filter((t=>!t)).keys()))),It=Object(h.a)([t=>t.getIn(["settings","notifications","quickFilter","show"]),t=>t.getIn(["settings","notifications","quickFilter","active"]),xt,t=>t.getIn(["notifications","items"])],((t,e,i,n)=>t&&"all"!==e?n.filter((t=>null===t||e===t.get("type"))):n.filterNot((t=>null!==t&&i.includes(t.get("type"))))));class Ft extends c.PureComponent{constructor(){super(...arguments),Object(a.a)(this,"state",{animatingNCD:!1}),Object(a.a)(this,"handleLoadGap",(t=>{this.props.dispatch(Object(P.Q)({maxId:t}))})),Object(a.a)(this,"handleLoadOlder",s()((()=>{const t=this.props.notifications.last();this.props.dispatch(Object(P.Q)({maxId:t&&t.get("id")}))}),300,{leading:!0})),Object(a.a)(this,"handleLoadPending",(()=>{this.props.dispatch(Object(P.V)())})),Object(a.a)(this,"handleScrollToTop",s()((()=>{this.props.dispatch(Object(P.db)(!0))}),100)),Object(a.a)(this,"handleScroll",s()((()=>{this.props.dispatch(Object(P.db)(!1))}),100)),Object(a.a)(this,"handlePin",(()=>{const{columnId:t,dispatch:e}=this.props;e(t?Object(w.h)(t):Object(w.e)("NOTIFICATIONS",{}))})),Object(a.a)(this,"handleMove",(t=>{const{columnId:e,dispatch:i}=this.props;i(Object(w.g)(e,t))})),Object(a.a)(this,"handleHeaderClick",(()=>{this.column.scrollTop()})),Object(a.a)(this,"setColumnRef",(t=>{this.column=t})),Object(a.a)(this,"handleMoveUp",(t=>{const e=this.props.notifications.findIndex((e=>null!==e&&e.get("id")===t))-1;this._selectChild(e,!0)})),Object(a.a)(this,"handleMoveDown",(t=>{const e=this.props.notifications.findIndex((e=>null!==e&&e.get("id")===t))+1;this._selectChild(e,!1)})),Object(a.a)(this,"handleTransitionEndNCD",(()=>{this.setState({animatingNCD:!1})})),Object(a.a)(this,"onEnterCleaningMode",(()=>{this.setState({animatingNCD:!0}),this.props.onEnterCleaningMode(!this.props.notifCleaningActive)})),Object(a.a)(this,"handleMarkAsRead",(()=>{this.props.dispatch(Object(P.Y)()),this.props.dispatch(Object(k.b)({immediate:!0}))}))}componentDidMount(){this.props.dispatch(Object(P.Z)())}componentWillUnmount(){this.handleLoadOlder.cancel(),this.handleScrollToTop.cancel(),this.handleScroll.cancel(),this.props.dispatch(Object(P.gb)())}_selectChild(t,e){const i=this.column.node,n=i.querySelector("article:nth-of-type(".concat(t+1,") .focusable"));n&&(e&&i.scrollTop>n.offsetTop?n.scrollIntoView(!0):!e&&i.scrollTop+i.clientHeight<n.offsetTop+n.offsetHeight&&n.scrollIntoView(!1),n.focus())}render(){const{intl:t,notifications:e,isLoading:i,isUnread:a,columnId:o,multiColumn:s,hasMore:c,numPending:l,showFilterBar:d,lastReadId:b,canMarkAsRead:h,needsNotificationPermission:u}=this.props,{notifCleaningActive:p}=this.props,{animatingNCD:M}=this.state,w=!!o,k=Object(n.a)(r.a,{id:"empty_column.notifications",defaultMessage:"You don't have any notifications yet. When other people interact with you, you will see it here."}),{signedIn:P}=this.props.identity;let F=null;const q=P&&d?Object(n.a)(kt,{}):null;let S;F=i&&this.scrollableContent?this.scrollableContent:e.size>0||c?e.map(((t,a)=>null===t?Object(n.a)(x.a,{disabled:i,maxId:a>0?e.getIn([a-1,"id"]):null,onClick:this.handleLoadGap},"gap:"+e.getIn([a+1,"id"])):Object(n.a)(Pt.a,{notification:t,accountId:t.get("account"),onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,unread:"0"!==b&&Object(v.a)(t.get("id"),b)>0},t.get("id")))):null,this.scrollableContent=F,S=P?Object(n.a)(I.a,{scrollKey:"notifications-".concat(o),trackScroll:!w,isLoading:i,showLoading:i&&0===e.size,hasMore:c,numPending:l,prepend:u&&Object(n.a)(tt,{}),alwaysPrepend:!0,emptyMessage:k,onLoadMore:this.handleLoadOlder,onLoadPending:this.handleLoadPending,onScrollToTop:this.handleScrollToTop,onScroll:this.handleScroll,bindToDocument:!s},void 0,F):Object(n.a)(C.a,{});const A=[];h&&A.push(Object(n.a)("button",{"aria-label":t.formatMessage(yt.markAsRead),title:t.formatMessage(yt.markAsRead),onClick:this.handleMarkAsRead,className:"column-header__button"},"mark-as-read",Object(n.a)(_.a,{id:"done-all",icon:j.a})));const D=f()("column-header__button",{active:p}),T=f()("ncd column-header__collapsible",{collapsed:!p,animating:M}),R=t.formatMessage(yt.enterNotifCleaning);A.push(Object(n.a)("button",{"aria-label":R,title:R,onClick:this.onEnterCleaningMode,className:D},"notif-cleaning",Object(n.a)(_.a,{id:"eraser",icon:O.a})));const L=Object(n.a)("div",{className:T,onTransitionEnd:this.handleTransitionEndNCD},void 0,Object(n.a)("div",{className:"column-header__collapsible-inner nopad-drawer"},void 0,p||M?Object(n.a)(U,{}):null));return Object(Nt.jsxs)(N.a,{bindToDocument:!s,ref:this.setColumnRef,extraClasses:this.props.notifCleaningActive?"notif-cleaning":null,label:t.formatMessage(yt.title),children:[Object(n.a)(y.b,{icon:"bell",iconComponent:m.a,active:a,title:t.formatMessage(yt.title),onPin:this.handlePin,onMove:this.handleMove,onClick:this.handleHeaderClick,pinned:w,multiColumn:s,localSettings:this.props.localSettings,extraButton:A,appendContent:L},void 0,Object(n.a)(ht,{})),q,Object(n.a)(Q,{}),S,Object(n.a)(g.a,{},void 0,Object(n.a)("title",{},void 0,t.formatMessage(yt.title)),Object(n.a)("meta",{name:"robots",content:"noindex"}))]})}}Object(a.a)(Ft,"defaultProps",{trackScroll:!0});e.default=Object(p.connect)((t=>({showFilterBar:t.getIn(["settings","notifications","quickFilter","show"]),notifications:It(t),localSettings:t.get("local_settings"),isLoading:t.getIn(["notifications","isLoading"],0)>0,isUnread:t.getIn(["notifications","unread"])>0||t.getIn(["notifications","pendingItems"]).size>0,hasMore:t.getIn(["notifications","hasMore"]),numPending:t.getIn(["notifications","pendingItems"],Object(u.List)()).size,notifCleaningActive:t.getIn(["notifications","cleaningMode"]),lastReadId:t.getIn(["settings","notifications","showUnread"])?t.getIn(["notifications","readMarkerId"]):"0",canMarkAsRead:t.getIn(["settings","notifications","showUnread"])&&"0"!==t.getIn(["notifications","readMarkerId"])&&It(t).some((e=>null!==e&&Object(v.a)(e.get("id"),t.getIn(["notifications","readMarkerId"]))>0)),needsNotificationPermission:t.getIn(["settings","notifications","alerts"]).includes(!0)&&t.getIn(["notifications","browserSupport"])&&"default"===t.getIn(["notifications","browserPermission"])&&!t.getIn(["settings","notifications","dismissPermissionBanner"])})),(t=>({onEnterCleaningMode(e){t(Object(P.O)(e))},dispatch:t})))(Object(M.e)(Object(d.c)(Ft)))}}]);
//# sourceMappingURL=notifications.js.map