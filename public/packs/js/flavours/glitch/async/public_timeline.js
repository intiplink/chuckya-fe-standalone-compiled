(window.webpackJsonp=window.webpackJsonp||[]).push([[533],{1993:function(e,t,o){"use strict";o.r(t);var n=o(0),l=o(2),a=(o(14),o(1)),s=o(8),i=o(26),c=o(54),d=o(247),r=o(10),m=o(282),g=o(2075),h=o(126),u=o(12),b=o(537),p=o(1739),y=o(85),O=o(1291),j=o(1289),M=o(2066),w=o(166),f=o(2076),I=o(2070);const _=Object(s.d)({filter_regex:{id:"home.column_settings.filter_regex",defaultMessage:"Filter out by regular expressions"}});class v extends a.PureComponent{render(){const{settings:e,onChange:t,intl:o}=this.props;return Object(n.a)("div",{className:"column-settings"},void 0,Object(n.a)("section",{},void 0,Object(n.a)("div",{className:"column-settings__row"},void 0,Object(n.a)(I.a,{settings:e,settingPath:["other","onlyMedia"],onChange:t,label:Object(n.a)(i.a,{id:"community.column_settings.media_only",defaultMessage:"Media only"})}),Object(n.a)(I.a,{settings:e,settingPath:["other","onlyRemote"],onChange:t,label:Object(n.a)(i.a,{id:"community.column_settings.remote_only",defaultMessage:"Remote only"})}),!e.getIn(["other","onlyRemote"])&&Object(n.a)(I.a,{settings:e,settingPath:["other","allowLocalOnly"],onChange:t,label:Object(n.a)(i.a,{id:"community.column_settings.allow_local_only",defaultMessage:"Show local-only toots"})}))),Object(n.a)("section",{},void 0,Object(n.a)("span",{className:"column-settings__section"},void 0,Object(n.a)(i.a,{id:"home.column_settings.advanced",defaultMessage:"Advanced"})),Object(n.a)("div",{className:"column-settings__row"},void 0,Object(n.a)(f.a,{settings:e,settingPath:["regex","body"],onChange:t,label:o.formatMessage(_.filter_regex)}))))}}var R=Object(c.c)(v);var L=Object(r.connect)(((e,t)=>{let{columnId:o}=t;const n=o,l=e.getIn(["settings","columns"]),a=l.findIndex((e=>e.get("uuid")===n));return{settings:n&&a>=0?l.get(a).get("params"):e.getIn(["settings","public"])}}),((e,t)=>{let{columnId:o}=t;return{onChange(t,n){e(o?Object(b.f)(o,t,n):Object(w.c)(["public",...t],n))}}}))(R),x=o(6);const C=Object(s.d)({title:{id:"column.public",defaultMessage:"Federated timeline"}});class P extends a.PureComponent{constructor(){super(...arguments),Object(l.a)(this,"handlePin",(()=>{const{columnId:e,dispatch:t,onlyMedia:o,onlyRemote:n,allowLocalOnly:l}=this.props;t(e?Object(b.h)(e):Object(b.e)(n?"REMOTE":"PUBLIC",{other:{onlyMedia:o,onlyRemote:n,allowLocalOnly:l}}))})),Object(l.a)(this,"handleMove",(e=>{const{columnId:t,dispatch:o}=this.props;o(Object(b.g)(t,e))})),Object(l.a)(this,"handleHeaderClick",(()=>{this.column.scrollTop()})),Object(l.a)(this,"setRef",(e=>{this.column=e})),Object(l.a)(this,"handleLoadMore",(e=>{const{dispatch:t,onlyMedia:o,onlyRemote:n,allowLocalOnly:l}=this.props;t(Object(y.z)({maxId:e,onlyMedia:o,onlyRemote:n,allowLocalOnly:l}))}))}componentDidMount(){const{dispatch:e,onlyMedia:t,onlyRemote:o,allowLocalOnly:n}=this.props,{signedIn:l}=this.props.identity;e(Object(y.z)({onlyMedia:t,onlyRemote:o,allowLocalOnly:n})),l&&(this.disconnect=e(Object(p.e)({onlyMedia:t,onlyRemote:o,allowLocalOnly:n})))}componentDidUpdate(e){const{signedIn:t}=this.props.identity;if(e.onlyMedia!==this.props.onlyMedia||e.onlyRemote!==this.props.onlyRemote||e.allowLocalOnly!==this.props.allowLocalOnly){const{dispatch:e,onlyMedia:o,onlyRemote:n,allowLocalOnly:l}=this.props;this.disconnect&&this.disconnect(),e(Object(y.z)({onlyMedia:o,onlyRemote:n,allowLocalOnly:l})),t&&(this.disconnect=e(Object(p.e)({onlyMedia:o,onlyRemote:n,allowLocalOnly:l})))}}componentWillUnmount(){this.disconnect&&(this.disconnect(),this.disconnect=null)}render(){const{intl:e,columnId:t,hasUnread:o,multiColumn:l,onlyMedia:a,onlyRemote:s,allowLocalOnly:c}=this.props,r=!!t;return Object(x.jsxs)(O.a,{bindToDocument:!l,ref:this.setRef,label:e.formatMessage(C.title),children:[Object(n.a)(j.b,{icon:"globe",iconComponent:m.a,active:o,title:e.formatMessage(C.title),onPin:this.handlePin,onMove:this.handleMove,onClick:this.handleHeaderClick,pinned:r,multiColumn:l},void 0,Object(n.a)(L,{columnId:t})),Object(n.a)(M.a,{prepend:Object(n.a)(g.a,{id:"public_timeline"},void 0,Object(n.a)(i.a,{id:"dismissable_banner.public_timeline",defaultMessage:"These are the most recent public posts from people on the social web that people on {domain} follow.",values:{domain:u.k}})),timelineId:"public".concat(s?":remote":c?":allow_local_only":"").concat(a?":media":""),onLoadMore:this.handleLoadMore,trackScroll:!r,scrollKey:"public_timeline-".concat(t),emptyMessage:Object(n.a)(i.a,{id:"empty_column.public",defaultMessage:"There is nothing here! Write something publicly, or manually follow users from other servers to fill it up"}),bindToDocument:!l,regex:this.props.regex}),Object(n.a)(d.a,{},void 0,Object(n.a)("title",{},void 0,e.formatMessage(C.title)),Object(n.a)("meta",{name:"robots",content:"noindex"}))]})}}Object(l.a)(P,"defaultProps",{onlyMedia:!1});t.default=Object(r.connect)(((e,t)=>{let{columnId:o}=t;const n=o,l=e.getIn(["settings","columns"]),a=l.findIndex((e=>e.get("uuid")===n)),s=o&&a>=0?l.get(a).getIn(["params","other","onlyMedia"]):e.getIn(["settings","public","other","onlyMedia"]),i=o&&a>=0?l.get(a).getIn(["params","other","onlyRemote"]):e.getIn(["settings","public","other","onlyRemote"]),c=o&&a>=0?l.get(a).getIn(["params","other","allowLocalOnly"]):e.getIn(["settings","public","other","allowLocalOnly"]),d=o&&a>=0?l.get(a).getIn(["params","regex","body"]):e.getIn(["settings","public","regex","body"]),r=e.getIn(["timelines","public".concat(i?":remote":c?":allow_local_only":"").concat(s?":media":"")]);return{hasUnread:!!r&&r.get("unread")>0,onlyMedia:s,onlyRemote:i,allowLocalOnly:c,regex:d}}))(Object(h.e)(Object(c.c)(P)))}}]);
//# sourceMappingURL=public_timeline.js.map